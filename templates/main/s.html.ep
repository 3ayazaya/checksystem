<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1" />
    <meta http-equiv="refresh" content="30">
    <link rel="stylesheet" href="/css/bootstrap.css">
    <link rel="stylesheet" href="/css/default2.css">
    <script src="/mojo/jquery/jquery.js"></script>
    <title><%= app->config->{cs}{ctf}{name} %></title>
  </head>
  <body>
    <div class="container" id="scoreboard_wrapper">
      <div id="scoreboard">
        <table class="table table-condensed">
          <thead>
            <tr>
              <th class="place">#</th>
              <th colspan="2">team</th>
              <th>score</th>
              % for my $sid (sort { $a <=> $b } keys %{app->services}) {
                <th class="service_name"><%= app->services->{$sid}{name} %></th>
              % }
            </tr>
          </thead>
          <tbody>
            % for my $team (@$scoreboard) {
            <tr class="team">
              % my $suffix = $team->{d} ? ($team->{d} > 0 ? "(+$team->{d})" : "($team->{d})") : '';
              <td class="place"><%= $team->{n} %><%= $suffix %></td>
              <td class="team_logo"><img height="48px" class="img" src="<%= app->teams->{$team->{team_id}}{logo} // '/logo.png' %>"></td>
              <td class="team_info">
                <div class="team_name"><%= $team->{name} %></div>
              </td>
              <td class="score"><%= $team->{score} %></td>
              % for my $service (@{$team->{services}}) {
                <td
                  title="<%= $service->{stdout} // '' %>"
                  class="team_service status_<%= app->model('checker')->status2name->{$service->{status} // ''} // '' %>"
                >
                  <div class="flags"><div class="param_name">Flags</div> <div class="param_value"><%= $service->{flags} %></div></div>
                </td>
              % }
            </tr>
            % }
          </tbody>
        </table>
      </div>
    </div>
    <script>
      $('img').error(function() { $(this).attr('src', '/logo.png'); });
    </script>
  </body>
</html>
